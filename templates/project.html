{% extends "layout.html" %}

{% block body %}
    {% load static %}

    <div class="project">
        <div class="d-flex align-items-center justify-content-center mb-3">
            <h2 class="mr-3 mb-0">{{ project.title }}</h2>
            <img src="{% static 'img' %}/{{project.project_logo}}" alt="{{ project.title }}">
        </div>
        
        <!-- Only show if admin -->
        <div class="text-right">
            <a href="{% url 'edit_project' project.id %}" class="btn btn-outline-secondary">Edit Project</a>
        </div>
        
        <div class="mt-4 mb-4">
            <hr>
        </div>

        <p>Project Users:</p>
        <ul class="list-group list-group-horizontal">
        {% for user in project_users %}
                <li class="list-group-item">{{ user}}</li>
            {% endfor %}
        </ul>

        {% if phases %}
            <div class="mt-4 mb-4">
                <hr>
            </div>
            <p>Project Phases:</p>
            <ul class="list-group list-group-flush">
                {% for phase in phases %}
                    <li class="list-group-item">
                        <p>{{ phase.name }}</p>
                        <p>Start: {{ phase.start_date }}</p>
                        <p>End: {{ phase.end_date }}</p>

                        <p>{{ phase.completed }}</p>
                        {% if phase.completed is False %}
                            <a class="completed_toggle btn btn-outline-danger" href="#" data-project="{{ project.id }}" data-completed="false" data-id="{{ phase.id }}">Not Completed</a>
                            <!-- <form action="{% url 'project' project.id %}" method="post">
                                {% csrf_token %}
                                <input type="hidden" name="phase_id" value="{{ phase.id }}">
                                <input type="submit" name="not_completed" class="btn btn-outline-danger" value="Not Completed">
                            </form> -->
                        {% else %}
                            <a class="completed_toggle btn btn-outline-success" href="#" data-project="{{ project.id }}" data-completed="true" data-id="{{ phase.id }}">Completed</a>
                            <!-- <form action="{% url 'project' project.id %}" method="post">
                                {% csrf_token %}
                                <input type="hidden" name="phase_id" value="{{ phase.id }}">
                                <input type="submit" name="completed" class="btn btn-outline-success" value="Completed">
                            </form> -->
                        {% endif %}
                    </li>

                {% endfor %}
            </ul>
        {% endif %}
       
        <h3 class="mt-4 mb-3">Add a new project phase:</h3>
        <form class="phase_form" data-id="{{ project.id }}" data-latest="{{ latest_phase_id }}">
            <!-- {% csrf_token %} -->
            <div class="form-group">
                <input class="form-control" type="text" name="name" id="name" placeholder="Phase Name">
            </div>
            <div class="form-group">
                <label for="notifications">Start Date</label>
                <input type="date" name="start" id="start">
            </div>
            <div class="form-group">
                <label for="notifications">End Date</label>
                <input type="date" name="end" id="end">
            </div>
            <div class="form-group">
                <label for="completed">Completed?</label>
                <input type="checkbox" name="completed" id="completed">
            </div>
            <input class="btn btn-primary" type="submit" name="add_phase" value="Add Phase">
        </form>
    </div>
{% endblock %}